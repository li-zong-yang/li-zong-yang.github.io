# å·¥å‚æ¨¡å¼

> ä½œè€…ï¼šç¬¬ä¸ƒäººæ ¼               
> é“¾æ¥ï¼šhttps://juejin.cn/post/7329164061391192099             
> æ¥æºï¼šç¨€åœŸæ˜é‡‘                  
> è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚                    

---------

âœ¨è¿™é‡Œæ˜¯ç¬¬ä¸ƒäººæ ¼çš„åšå®¢âœ¨å°ä¸ƒï¼Œæ¬¢è¿æ‚¨çš„åˆ°æ¥~âœ¨

ğŸ…ç³»åˆ—ä¸“æ ï¼šè®¾è®¡æ¨¡å¼ğŸ…

âœˆï¸æœ¬ç¯‡å†…å®¹: å·¥å‚æ¨¡å¼âœˆï¸

ğŸ±æœ¬ç¯‡æ”¶å½•å®Œæ•´ä»£ç åœ°å€ï¼š[gitee.com/diqirenge/dâ€¦](https://link.juejin.cn?target=https%3A%2F%2Fgitee.com%2Fdiqirenge%2Fdesign-pattern "https://gitee.com/diqirenge/design-pattern") ğŸ±

## æ¥”å­

è®°å¾—åˆšå…¥è¡Œçš„æ—¶å€™ï¼Œå¬è¿‡ä¸€ä¸ªæ®µå­ï¼ŒåŒæ ·å¼€å‘ä¸€ä¸ªåŠŸèƒ½åˆçº§ç¨‹åºå‘˜è¦1å¤©ï¼Œä¸­çº§ç¨‹åºå‘˜è¦2å¤©ï¼Œé«˜çº§ç¨‹åºå‘˜è¦1ä¸ªæ˜ŸæœŸã€‚å½“æ—¶ä»¥ä¸ºæ˜¯è€æ²¹æ¡åˆ’æ°´ï¼ˆè™½ç„¶è‚¯å®šè¿˜æ˜¯ä¼šåˆ’ä¸€ç‚¹æ°´ï¼Œå“ˆå“ˆï¼‰ï¼Œä½†æ˜¯å…¶å®æ›´é‡è¦çš„è¿˜æ˜¯è®¾è®¡æ€æƒ³çš„ä¸åŒï¼Œç»éªŒä¸°å¯Œçš„ç¨‹åºå‘˜å¾€å¾€è€ƒè™‘çš„æ›´å¤šï¼Œä¸å…‰æ˜¯ä¸šåŠ¡æ‹“å±•æ€§ï¼Œæ›´æœ‰ç¨‹åºæ‹“å±•æ€§ã€‚

## éœ€æ±‚èƒŒæ™¯

å®ç°ä¸€ä¸ªå›¾ç‰‡ä¸Šä¼ åŠŸèƒ½ï¼Œé€»è¾‘å¾ˆç®€å•ï¼Œå°±æ˜¯æŠŠå›¾ç‰‡ä¸Šä¼ åˆ°å¯¹è±¡å­˜å‚¨ï¼Œä½†æ˜¯ç°åœ¨æœ‰ä¸¤ä¸ªæœåŠ¡å•†å¯ä»¥é€‰æ‹©ï¼Œä»–ä»¬åˆ†åˆ«æ˜¯é˜¿é‡Œäº‘å’Œè…¾è®¯äº‘ï¼Œå¹¶ä¸”ç°åœ¨æ²¡æœ‰æ•²å®šç”¨å“ªä¸€ä¸ªï¼Œéœ€è¦ä½ å…ˆå¯¹æ¥ã€‚ä»–ä»¬æä¾›çš„APIå„ä¸ç›¸åŒï¼Œæˆ‘ä»¬å‡è®¾ä»–ä»¬æä¾›çš„APIå¦‚ä¸‹

| æ¸ é“   | æ¥å£                                                         |
| ------ | ------------------------------------------------------------ |
| é˜¿é‡Œäº‘ | void aliUpload(String fileName, String ossId, String token); |
| è…¾è®¯äº‘ | String tencentUpload(String fileName, String base64, String appID, String appSecret); |

## åˆ†æè®¾è®¡

å› ä¸ºè¿™2ä¸ªæ¥å£çš„å®ç°çš„å®šä¹‰ä¸ä¸€æ ·ï¼Œæ‰€ä»¥æˆ‘ä»¬æœ€å¥½èƒ½æŠ½è±¡å‡ºä¸€ä¸ªç»Ÿä¸€çš„æ¥å£ï¼Œè®©å­ç±»å»å®ç°è‡ªå·±çš„ä¸šåŠ¡é€»è¾‘ï¼Œè¿™æ ·çš„å¥½å¤„æ˜¯ä»¥åè…¾è®¯äº‘æœ‰å˜æ›´ï¼Œå°±æ”¹è…¾è®¯äº‘ï¼Œé˜¿é‡Œäº‘æœ‰å˜æ›´å°±æ”¹é˜¿é‡Œäº‘ï¼Œä¸¤ä¸ªå­ç±»äº’ä¸å½±å“ï¼ˆæ»¡è¶³å•ä¸€èŒè´£åŸåˆ™ï¼‰ã€‚

åˆä¸ºäº†ä¸è®©ä¸Šå±‚ç›´æ¥ä½¿ç”¨æˆ‘ä»¬è¿™ä¸ªç»Ÿä¸€çš„æ–¹æ³•ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å†æŠ½è±¡ä¸€ä¸ªç±»ï¼Œè®©ä»–æ¥å†³å®šç”¨å“ªä¸€ä¸ªä¸Šä¼ æ–¹å¼ï¼Œç›¸å½“äºåŠ äº†ä¸€å±‚é˜²è…ï¼Œè¿™é‡Œæˆ‘ä»¬æŠŠä»–å«åšå·¥å‚ç±»ï¼ˆåˆ›å»ºè€…ä¸å…·ä½“çš„ä¸šåŠ¡è§£è€¦ï¼‰ã€‚

å†æƒ³ä¸€ä¸‹æ‹“å±•æƒ…å†µï¼Œå¦‚æœä»¥ååˆåŠ ä¸€ç§ä¸Šä¼ æ–¹å¼ï¼Œæ¯”å¦‚åä¸ºäº‘ï¼Œé‚£æˆ‘ä»¬ä¿®æ”¹èµ·æ¥ä¹Ÿéå¸¸æ–¹ä¾¿ï¼Œåªè¦å†åŠ ä¸€ä¸ªå­ç±»å°±å¯ä»¥äº†ï¼Œè°ƒç”¨æ–¹å¯ä»¥ä¸ç”¨å˜ï¼ˆæ»¡â¾œå¼€é—­åŸåˆ™ï¼‰ã€‚

## UMLå›¾

æ ¹æ®åˆ†æè®¾è®¡ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆç”»ä¸€ä¸ªç®€å•çš„UMLå›¾ï¼Œåé¢é€šè¿‡UMLå›¾ç¼–ç 

![å·¥å‚æ¨¡å¼UML.png](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/b832d5bc361d4fc7b1c17efbf11f5ecb~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=1876&h=884&s=90119&e=png&b=242528)

## æ¨¡å—åç§°

factory

## æ¨¡å—åœ°å€

[gitee.com/diqirenge/dâ€¦](https://link.juejin.cn?target=https%3A%2F%2Fgitee.com%2Fdiqirenge%2Fdesign-pattern%2Ftree%2Fmaster%2Fsrc%2Fmain%2Fjava%2Fcom%2Frun2code%2Fdesign%2Fcreational%2Ffactory "https://gitee.com/diqirenge/design-pattern/tree/master/src/main/java/com/run2code/design/creational/factory")

## æ¨¡å—æè¿°

å·¥å‚æ¨¡å¼ä»£ç ç¤ºä¾‹

## ä»£ç å®ç°

1ã€é¦–å…ˆæˆ‘ä»¬æ¨¡æ‹Ÿå‡ºä¸¤ä¸ªå¤–éƒ¨æ¥å£

ä¸Šä¼ è‡³oss

```java
 ä»£ç è§£è¯»/**
 * ä¸Šä¼ è‡³oss
 * å…³æ³¨å…¬ä¼—å·ã€å¥”è·‘çš„ç ç•œã€‘ï¼Œä¸€èµ·è¿›æ­¥ä¸è¿·è·¯
 *
 * @author ç¬¬ä¸ƒäººæ ¼
 * @date 2023/11/17
 */
public class AliOss {
    public void aliUpload(String fileName, String ossId, String token) {
        System.out.println("ali upload å…¥å‚ï¼š " + fileName + " " + ossId + " " + token);
        System.out.println("ali ä¸Šä¼ æˆåŠŸï¼");
    }
}
```

ä¸Šä¼ è‡³cos

```java
 ä»£ç è§£è¯»/**
 * ä¸Šä¼ è‡³cos
 * å…³æ³¨å…¬ä¼—å·ã€å¥”è·‘çš„ç ç•œã€‘ï¼Œä¸€èµ·è¿›æ­¥ä¸è¿·è·¯
 *
 * @author ç¬¬ä¸ƒäººæ ¼
 * @date 2023/11/17
 */
public class TencentCos {
    public String tencentUpload(String fileName, String base64, String appID, String appSecret) {
        System.out.println("tencent upload å…¥å‚ï¼š " + fileName + " " + base64 + " " + appID + " " + appSecret);

        return "æˆåŠŸä¸Šä¼ åˆ°è…¾è®¯äº‘";
    }
}
```

2ã€ç„¶åå®šä¹‰ä¸€ä¸ªç”¨äºåˆ›å»ºå¯¹è±¡çš„æ¥å£æˆ–æŠ½è±¡ç±»ï¼Œè®©å­ç±»å†³å®šå®ä¾‹åŒ–å“ªä¸€ä¸ªç±»

æŠ½è±¡ç±»

```java
 ä»£ç è§£è¯»/**
 * æŠ½è±¡çš„ä¸Šä¼ æ“ä½œç±»ï¼Œå½“ç„¶ä»–ä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªæ¥å£
 * å…³æ³¨å…¬ä¼—å·ã€å¥”è·‘çš„ç ç•œã€‘ï¼Œä¸€èµ·è¿›æ­¥ä¸è¿·è·¯
 *
 * @author ç¬¬ä¸ƒäººæ ¼
 * @date 2023/11/15
 */
public abstract class BaseUpDownloader {
    /**
     * æ‰§è¡Œæ–‡ä»¶ä¸Šä¼ æ“ä½œï¼ˆå»¶è¿Ÿåˆ°å­ç±»å®ç°ï¼‰
     *
     * @param filePath æ–‡ä»¶è·¯å¾„
     * @param fileName æ–‡ä»¶åç§°
     * @param param    ç¬¬ä¸‰æ–¹å‚æ•°
     * @return {@link String}
     */
    public abstract String doUpload(String filePath, String fileName, Map<String, String> param);
}
```

ä¸Šä¼ å­ç±» ossï¼Œç»§æ‰¿äº†æŠ½è±¡ç±»ï¼Œå¹¶ä¸”è°ƒç”¨äº†ä¸Šä¼ è‡³ossçš„æ–¹æ³•

```java
 ä»£ç è§£è¯»/**
 * ä¸Šä¼ å­ç±» oss
 * å…³æ³¨å…¬ä¼—å·ã€å¥”è·‘çš„ç ç•œã€‘ï¼Œä¸€èµ·è¿›æ­¥ä¸è¿·è·¯
 *
 * @author ç¬¬ä¸ƒäººæ ¼
 * @date 2023/11/15
 */
public class AliOssUpDownloader extends BaseUpDownloader {

    private AliOss aliOss;

    public AliOssUpDownloader() {
        this.aliOss = new AliOss();
    }

    @Override
    public String doUpload(String filePath, String fileName, Map<String, String> param) {
        aliOss.aliUpload(fileName, param.get("ossId"), param.get("token"));
        return "AliOssUpDownloader upload success";
    }
}
```

ä¸Šä¼ å­ç±» cosï¼Œç»§æ‰¿äº†æŠ½è±¡ç±»ï¼Œå¹¶ä¸”è°ƒç”¨äº†ä¸Šä¼ è‡³ossçš„æ–¹æ³•

```java
 ä»£ç è§£è¯»/**
 * ä¸Šä¼ å­ç±» cosï¼Œç»§æ‰¿äº†æŠ½è±¡ç±»ï¼Œå¹¶ä¸”è°ƒç”¨äº†ä¸Šä¼ è‡³ossçš„æ–¹æ³•
 * å…³æ³¨å…¬ä¼—å·ã€å¥”è·‘çš„ç ç•œã€‘ï¼Œä¸€èµ·è¿›æ­¥ä¸è¿·è·¯
 *
 * @author ç¬¬ä¸ƒäººæ ¼
 * @date 2023/11/15
 */
public class TencentUpDownloader extends BaseUpDownloader {

    private TencentCos tencentCos;

    public TencentUpDownloader() {
        this.tencentCos = new TencentCos();
    }

    @Override
    public String doUpload(String filePath, String fileName, Map<String, String> param) {
        String result = tencentCos.tencentUpload(fileName, param.get("base64"), param.get("appID"), param.get("appSecret"));
        System.out.println(result);
        return "TencentUpDownloader upload success";
    }
}
```

3ã€åˆ›å»ºä¸€ä¸ªå·¥å‚ç±»ï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ªç”¨äºåˆ›å»ºäº§å“å¯¹è±¡çš„æ–¹æ³•ã€‚

```java
 ä»£ç è§£è¯»/**
 * ä¸Šä¼ çš„å·¥å‚ç±»
 * å…³æ³¨å…¬ä¼—å·ã€å¥”è·‘çš„ç ç•œã€‘ï¼Œä¸€èµ·è¿›æ­¥ä¸è¿·è·¯
 *
 * @author ç¬¬ä¸ƒäººæ ¼
 * @date 2023/11/17
 */
public class UpDownloaderFactory {
    /**
     * æ³¨å†Œä¸Šä¼ ä¸‹è½½å¯¹è±¡åˆ°å·¥å‚ã€‚
     *
     * @param upDownloaderName ä¸‹è½½å™¨åç§°
     * @return {@link BaseUpDownloader}
     */
    public BaseUpDownloader registerUpDownloader(String upDownloaderName) {
        if ("tencent".equalsIgnoreCase(upDownloaderName)) {
            return new TencentUpDownloader();
        } else if ("ali".equalsIgnoreCase(upDownloaderName)) {
            return new AliOssUpDownloader();
        }
        return null;
    }
}
```

4ã€ç¼–å†™æµ‹è¯•æ–¹æ³•

```java
 ä»£ç è§£è¯»/**
 * æµ‹è¯•å·¥å‚æ¨¡å¼
 * å…³æ³¨å…¬ä¼—å·ã€å¥”è·‘çš„ç ç•œã€‘ï¼Œä¸€èµ·è¿›æ­¥ä¸è¿·è·¯
 *
 * @author ç¬¬ä¸ƒäººæ ¼
 * @date 2023/11/17
 */
public class UpDownloaderFactoryTest {

    /**
     * æµ‹è¯•è°ƒç”¨é˜¿é‡Œä¸Šä¼ 
     */
    @Test
    public void testAli() {
        UpDownloaderFactory factory = new UpDownloaderFactory();
        BaseUpDownloader upDownloader = factory.registerUpDownloader("ali");

        Map<String, String> param = new HashMap<>();
        param.put("ossId", "ossId");
        param.put("token", "token");

        if (upDownloader == null) {
            return;
        }

        System.out.println("==========ä¸Šä¼ å¼€å§‹==========");
        String result = upDownloader.doUpload("/temp/file", "é˜¿é‡Œæ–‡ä»¶.pdf", param);
        System.out.println("ç»“æœï¼š" + result);
        System.out.println("==========ä¸Šä¼ ç»“æŸ==========");
    }

    /**
     * æµ‹è¯•è°ƒç”¨è…¾è®¯ä¸Šä¼ 
     */
    @Test
    public void testTencent() {
        UpDownloaderFactory factory = new UpDownloaderFactory();
        BaseUpDownloader upDownloader = factory.registerUpDownloader("tencent");

        Map<String, String> param = new HashMap<>();
        param.put("base64", "base64");
        param.put("appID", "appID");
        param.put("appSecret", "appSecret");

        if (upDownloader == null) {
            return;
        }

        System.out.println("==========ä¸Šä¼ å¼€å§‹==========");
        String result = upDownloader.doUpload("/temp/file", "è…¾è®¯æ–‡ä»¶.pdf", param);
        System.out.println("ç»“æœï¼š" + result);
        System.out.println("==========ä¸Šä¼ ç»“æŸ==========");
    }

}
```

5ã€æµ‹è¯•ç»“æœ

â‘ æ‰§è¡ŒtestAliæ–¹æ³•

> \==========ä¸Šä¼ å¼€å§‹==========
>
> ali upload å…¥å‚ï¼š é˜¿é‡Œæ–‡ä»¶.pdf ossId token
>
> ali ä¸Šä¼ æˆåŠŸï¼
>
> ç»“æœï¼šAliOssUpDownloader upload success
>
> \==========ä¸Šä¼ ç»“æŸ==========

â‘¡æ‰§è¡ŒtestTencentæ–¹æ³•

> \==========ä¸Šä¼ å¼€å§‹==========
>
> tencent upload å…¥å‚ï¼š è…¾è®¯æ–‡ä»¶.pdf base64 appID appSecret
>
> æˆåŠŸä¸Šä¼ åˆ°è…¾è®¯äº‘
>
> ç»“æœï¼šTencentUpDownloader upload success
>
> \==========ä¸Šä¼ ç»“æŸ==========

## å®ç°è¦ç‚¹

1. å®šä¹‰ä¸€ä¸ªç”¨äºåˆ›å»ºå¯¹è±¡çš„æ¥å£æˆ–æŠ½è±¡ç±»ï¼Œè®©å­ç±»å†³å®šå®ä¾‹åŒ–å“ªä¸€ä¸ªç±»ã€‚

   ç¤ºä¾‹ä¸­ä¸ºï¼šBaseUpDownloader

2. åˆ›å»ºä¸€ä¸ªå·¥å‚ç±»ï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ªç”¨äºåˆ›å»ºäº§å“å¯¹è±¡çš„æ–¹æ³•ã€‚

   ç¤ºä¾‹ä¸­ï¼Œå·¥å‚ç±»ä¸ºï¼šUpDownloaderFactoryï¼›åˆ›å»ºäº§å“å¯¹è±¡çš„æ–¹æ³•ä¸ºï¼šregisterUpDownloader

3. åœ¨å®¢æˆ·ç«¯ä»£ç ä¸­ï¼Œé€šè¿‡è°ƒç”¨å·¥å‚ç±»çš„æ–¹æ³•æ¥åˆ›å»ºæ‰€éœ€çš„äº§å“å¯¹è±¡ï¼Œè€Œæ— éœ€ç›´æ¥è°ƒç”¨å…·ä½“çš„äº§å“ç±»çš„æ„é€ å‡½æ•°ã€‚

   ç¤ºä¾‹ä¸­ä¸ºï¼š

   UpDownloaderFactory factory = new UpDownloaderFactory();

   BaseUpDownloader upDownloader = factory.registerUpDownloader("ali");

## æ€»ç»“

æœ¬æ–‡ä»æ¨¡æ‹Ÿéœ€æ±‚å¼€å§‹ï¼Œå¸¦ç€è¯»è€…ä¸€èµ·å­¦ä¹ äº†å·¥å‚æ¨¡å¼ï¼Œä»ä¸Šæ–‡å¯çŸ¥å·¥å‚æ¨¡å¼å…¶å®éå¸¸ç®€å•ï¼ŒæŒæ¡ä¸‰å¤§å®ç°è¦ç‚¹å°±å¯ä»¥äº†ã€‚æ‰€ä»¥å°ä¸ƒåœ¨å·¥ä½œä¸­ä½¿ç”¨å·¥å‚æ¨¡å¼çš„é¢‘ç‡ä¹Ÿéå¸¸çš„é«˜ï¼Œä½†æ˜¯å·¥å‚æ¨¡å¼ä¸€èˆ¬æ˜¯ä¸ä¼šå•ç‹¬ä½¿ç”¨çš„ï¼Œä»–çš„å¥½ä¼™ä¼´æœ‰ç­–ç•¥æ¨¡å¼ã€å•ä¾‹æ¨¡å¼ã€æ¨¡ç‰ˆæ¨¡å¼ç­‰ç­‰ï¼Œåé¢å°ä¸ƒéƒ½ä¼šè®²åˆ°ã€‚