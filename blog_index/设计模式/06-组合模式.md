# ç»„åˆæ¨¡å¼

> ä½œè€…ï¼šç¬¬ä¸ƒäººæ ¼               
> é“¾æ¥ï¼šhttps://juejin.cn/post/7329413905029038092             
> æ¥æºï¼šç¨€åœŸæ˜é‡‘                  
> è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚                    

---------

âœ¨è¿™é‡Œæ˜¯ç¬¬ä¸ƒäººæ ¼çš„åšå®¢âœ¨å°ä¸ƒï¼Œæ¬¢è¿æ‚¨çš„åˆ°æ¥~âœ¨

ğŸ…ç³»åˆ—ä¸“æ ï¼šè®¾è®¡æ¨¡å¼ğŸ…

âœˆï¸æœ¬ç¯‡å†…å®¹ï¼šç»„åˆæ¨¡å¼âœˆï¸

ğŸ±æœ¬ç¯‡æ”¶å½•å®Œæ•´ä»£ç åœ°å€ï¼š[gitee.com/diqirenge/dâ€¦](https://link.juejin.cn?target=https%3A%2F%2Fgitee.com%2Fdiqirenge%2Fdesign-pattern "https://gitee.com/diqirenge/design-pattern")ğŸ±

## æ¥”å­

å°ä¸ƒæœ€è¿‘å·¥ä½œå¯ä»¥è¯´æ˜¯å¿™åˆ°é£èµ·ï¼Œæœ¬æ¥æƒ³ç€ä»Šå¤©ä¼‘æ¯ä¸€ä¸‹å°±ä¸å†æ›´æ–°äº†ã€‚ä½†æ˜¯ï¼ä½†æ˜¯ï¼ä½†æ˜¯ï¼

ä»Šå¤©ä¸‹åˆå±…ç„¶è¢«ç¾¤å‹æ¨èé¼“åŠ±äº†o(*ï¿£â–½ï¿£*)ãƒ–ï¼Œé‚£å¿…é¡»å¾—å†å¹²å®ƒä¸€ç¯‡ï¼

![image.png](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/0443e0eaaf164d9897240515d3bb8b59~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=1003&h=618&s=51655&e=png&b=f5f5f5)

psï¼šæœ‰äº›æœ‹å‹è§‰å¾—è®¾è®¡æ¨¡å¼å¤ªç®€å•äº†ï¼Œå¸Œæœ›å°ä¸ƒèŠèŠJUCå’ŒSpringæºç ã€‚å°ä¸ƒåªæƒ³è¯´ä¸è¦æ–¹(â—Ë‡âˆ€Ë‡â—)ï¼Œç­‰è®¾è®¡æ¨¡å¼è¿™ä¸ªä¸“æ å†™å®Œäº†ï¼Œå°±å¼€å§‹æ›´æ–°JUCç›¸å…³çŸ¥è¯†ã€‚

å¤§çº²éƒ½å·²ç»æœ‰äº†ï¼Œå¯ä»¥æµè§ˆå°ä¸ƒçš„github-pageå°å°é²œ [li-zong-yang.github.io/#/guide\_indâ€¦](https://link.juejin.cn?target=https%3A%2F%2Fli-zong-yang.github.io%2F%23%2Fguide_index%2F002-Java%25E5%25B9%25B6%25E5%258F%2591%25E7%25BC%2596%25E7%25A8%258B "https://li-zong-yang.github.io/#/guide_index/002-Java%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B")

## éœ€æ±‚èƒŒæ™¯

2022å¹´å°ä¸ƒç ”ç©¶è¿‡ä¸€æ®µæ—¶é—´çš„æ¥å£ç¼–æ’ï¼Œå½“æ—¶è¿˜ç»™liteFlowæè¿‡ä¸€ä¸ªIssues

![ç»„åˆ.jpg](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/52230d640a6847c08a4d67a19d9ceebc~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=1011&h=473&s=39457&e=png&b=fdfdfd)

Issuesä¸­ä¸¾ä¾‹çš„ä¸šåŠ¡åœºæ™¯å°±å¾ˆé€‚åˆä½¿ç”¨ç»„åˆæ¨¡å¼ã€‚

æˆ‘ä»¬å†å°†è¿™ä¸ªéœ€æ±‚ç®€å•æè¿°ä¸€ä¸‹ï¼š

1ã€æˆ‘ä»¬æœ‰2ç§æ£€éªŒæ³¨å†Œçš„æ‰‹æ®µ a.æ‰‹æœºå· bèº«ä»½è¯

2ã€è¿™ä¸¤ç§æ ¡éªŒæ‰‹æ®µåœ¨ä¸åŒçš„ä¸šåŠ¡åœºæ™¯ä¸‹ï¼Œæœ‰ä¸åŒçš„ç»„åˆï¼Œå¯ä»¥éƒ½å‚ä¸æ ¡éªŒï¼Œä¹Ÿå¯ä»¥åªæœ‰ä¸€ä¸ªå‚ä¸æ ¡éªŒã€‚

## åˆ†æè®¾è®¡

ä¸ºäº†è®©æˆ‘ä»¬çš„æ ¡éªŒåŠŸèƒ½ï¼Œèƒ½å¤Ÿè¿›â¾â¾ƒç”±ç»„åˆå¯¹å¤–æä¾›æœåŠ¡ã€‚æˆ‘ä»¬å¯ä»¥æŠŠè¿™ä¸¤ç§æ ¡éªŒæ‰‹æ®µæƒ³è±¡æˆä¸¤ç‰‡å¶å­ï¼Œä»–ä»¬å¯ä»¥è‡ªç”±ç»„åˆæˆä¸€æ£µå®Œæ•´çš„æ ‘ã€‚

![ç»„åˆæ ‘.jpg](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/da492e9052494a92a6dc20a163c78b6f~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=1510&h=361&s=48887&e=png&b=fdfdfd)

é¦–å…ˆæˆ‘ä»¬æŠ½è±¡å‡ºç»„ä»¶æ¥å£ComponentCheckerï¼Œè®©ä¸¤ä¸ªå…·ä½“çš„æ ¡éªŒç±»éƒ½å®ç°å®ƒï¼›

ç„¶åæˆ‘ä»¬å®šä¹‰ç»„åˆèŠ‚ç‚¹Compositeï¼Œå¯ä»¥å…ˆç†è§£æˆå›¾ä¸­çš„rootï¼Œå®ƒé‡Œé¢è¦åŒ…å«å­èŠ‚ç‚¹ï¼Œæ‰€ä»¥æˆ‘ä»¬å¾—æœ‰ä¸€ä¸ªlistçš„å±æ€§

```java
 ä»£ç è§£è¯»/**
 * å¯ä»¥å­˜æ”¾å­èŠ‚ç‚¹
 */
private List<ComponentChecker> children;
```

## UMLå›¾

æ ¹æ®åˆ†æè®¾è®¡ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆç”»ä¸€ä¸ªç®€å•çš„UMLå›¾ï¼Œåé¢é€šè¿‡UMLå›¾ç¼–ç 

![ComponentChecker-url.png](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/dbdf3fc2d86f49fdb61bc70edc8608d7~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=1210&h=610&s=40040&e=png&b=2e2e2e)

## æ¨¡å—åç§°

composite

## æ¨¡å—åœ°å€

[gitee.com/diqirenge/dâ€¦](https://link.juejin.cn?target=https%3A%2F%2Fgitee.com%2Fdiqirenge%2Fdesign-pattern%2Ftree%2Fmaster%2Fsrc%2Fmain%2Fjava%2Fcom%2Frun2code%2Fdesign%2Fstructural%2Fcomposite "https://gitee.com/diqirenge/design-pattern/tree/master/src/main/java/com/run2code/design/structural/composite")

## æ¨¡å—æè¿°

ç»„åˆæ¨¡å¼ä»£ç ç¤ºä¾‹

## ä»£ç å®ç°

1ã€å®šä¹‰ç»„ä»¶æ¥å£

```java
 ä»£ç è§£è¯»/**
 * å®šä¹‰ç»„ä»¶æ¥å£
 * å…³æ³¨å…¬ä¼—å·ã€å¥”è·‘çš„ç ç•œã€‘ï¼Œä¸€èµ·è¿›æ­¥ä¸è¿·è·¯
 *
 * @author ç¬¬ä¸ƒäººæ ¼
 * @date 2023/11/30
 */
public interface ComponentChecker {
    /**
     * æ ¡éªŒ
     */
    void check();
}
```

å…·ä½“å®ç°å­ç±»-èº«ä»½è¯æ ¡éªŒå™¨

```java
 ä»£ç è§£è¯»/**
 * å­èŠ‚ç‚¹ - èº«ä»½è¯æ ¡éªŒå™¨
 * å…³æ³¨å…¬ä¼—å·ã€å¥”è·‘çš„ç ç•œã€‘ï¼Œä¸€èµ·è¿›æ­¥ä¸è¿·è·¯
 *
 * @author ç¬¬ä¸ƒäººæ ¼
 * @date 2023/11/30
 */
class IdCardChecker implements ComponentChecker {
    private String number;

    public IdCardChecker(String number) {
        this.number = number;
    }

    @Override
    public void check() {
        System.out.println("æ ¡éªŒèº«ä»½è¯[" + number + "]è¢«æ‰§è¡Œäº†...");
    }

    @Override
    public String toString() {
        return "IdCard{" +
                "number='" + number + '\'' +
                '}';
    }
}
```

å…·ä½“å®ç°å­ç±»-ç”µè¯æ ¡éªŒå™¨

```java
 ä»£ç è§£è¯»/**
 * å­èŠ‚ç‚¹ - ç”µè¯æ ¡éªŒå™¨
 * å…³æ³¨å…¬ä¼—å·ã€å¥”è·‘çš„ç ç•œã€‘ï¼Œä¸€èµ·è¿›æ­¥ä¸è¿·è·¯
 *
 * @author ç¬¬ä¸ƒäººæ ¼
 * @date 2023/11/30
 */
class PhoneChecker implements ComponentChecker {
    private String number;

    public PhoneChecker(String number) {
        this.number = number;
    }

    @Override
    public void check() {
        System.out.println("æ ¡éªŒç”µè¯å·ç [" + number + "]è¢«æ‰§è¡Œäº†...");
    }

    @Override
    public String toString() {
        return "Phone{" +
                "number='" + number + '\'' +
                '}';
    }
}
```

2ã€å®šä¹‰ç»„åˆèŠ‚ç‚¹

å…³é”®ç‚¹æ˜¯è¦å°†ç»„ä»¶æ¥å£çš„é›†åˆä½œä¸ºå±æ€§æ”¾åˆ°ç±»ä¸­

```java
 ä»£ç è§£è¯»/**
 * å®šä¹‰ç»„åˆèŠ‚ç‚¹
 * å…³æ³¨å…¬ä¼—å·ã€å¥”è·‘çš„ç ç•œã€‘ï¼Œä¸€èµ·è¿›æ­¥ä¸è¿·è·¯
 *
 * @author ç¬¬ä¸ƒäººæ ¼
 * @date 2023/11/30
 */
class Composite implements ComponentChecker {
    private String name;
    /**
     * å¯ä»¥å­˜æ”¾å­èŠ‚ç‚¹
     */
    private List<ComponentChecker> children;

    public Composite(String name) {
        this.name = name;
        this.children = new ArrayList<>();
    }

    /**
     * æ·»åŠ å­èŠ‚ç‚¹
     *
     * @param child æ·»åŠ çš„èŠ‚ç‚¹
     */
    public void addChild(ComponentChecker child) {
        children.add(child);
    }

    /**
     * ç§»é™¤å­èŠ‚ç‚¹
     *
     * @param child åˆ é™¤çš„èŠ‚ç‚¹
     */
    public void removeChild(ComponentChecker child) {
        children.remove(child);
    }

    @Override
    public void check() {
        System.out.println("ç»„åˆèŠ‚ç‚¹[" + name + "]å‡†å¤‡å¼€å§‹æ‰§è¡Œ\nå¶å­èŠ‚ç‚¹æ•°æ®ä¸ºï¼š" + children.toString() + "\n");
        for (ComponentChecker child : children) {
            child.check();
        }
    }

    @Override
    public String toString() {
        return "Composite{" +
                "name='" + name + '\'' +
                ", children=" + children +
                '}';
    }
}
```

3ã€ç¼–å†™æµ‹è¯•ç±»

```java
 ä»£ç è§£è¯»/**
 * æµ‹è¯•ç»„åˆæ¨¡å¼
 * å…³æ³¨å…¬ä¼—å·ã€å¥”è·‘çš„ç ç•œã€‘ï¼Œä¸€èµ·è¿›æ­¥ä¸è¿·è·¯
 *
 * @author ç¬¬ä¸ƒäººæ ¼
 * @date 2023/11/29
 */
public class CompositeTest {
    @Test
    public void testBridge() {
        // åˆ›å»ºæ ¹èŠ‚ç‚¹ï¼Œä»–æ˜¯ä¸€ä¸ªç»„åˆèŠ‚ç‚¹
        Composite root = new Composite("æ ¹èŠ‚ç‚¹");

        // åˆ›å»ºå¶å­èŠ‚ç‚¹1
        IdCardChecker leaf1 = new IdCardChecker("500383*********");
        root.addChild(leaf1);

        // åˆ›å»ºå¶å­èŠ‚ç‚¹2
        PhoneChecker leaf2 = new PhoneChecker("186*********");
        root.addChild(leaf2);

        // æ‰§è¡Œæ“ä½œ
        root.check();
    }
}
```

5ã€æµ‹è¯•ç»“æœ

> ç»„åˆèŠ‚ç‚¹\[æ ¹èŠ‚ç‚¹\]å‡†å¤‡å¼€å§‹æ‰§è¡Œ
>
> å¶å­èŠ‚ç‚¹æ•°æ®ä¸ºï¼š\[IdCard{number='500383 . . . . . . . . . '}, Phone{number='186 . . . . . . . . \*'}\]
>
> æ ¡éªŒèº«ä»½è¯\[500383 . . . . . . . . . \*\]è¢«æ‰§è¡Œäº†...
>
> æ ¡éªŒç”µè¯å·ç \[186. . . . . . . . . . . \*\]è¢«æ‰§è¡Œäº†...

## å®ç°è¦ç‚¹

1. æŠ½è±¡ç»„ä»¶ï¼ˆComponentï¼‰ï¼šå®šä¹‰åˆ›å»ºå¯¹è±¡çš„æ¥å£ï¼Œå…è®¸å®¢æˆ·ç«¯ç‹¬ç«‹åœ°è·å–ç»„ä»¶å¯¹è±¡ã€‚

   æ–‡ä¸­ç¤ºä¾‹ä¸ºï¼šComponentChecker

2. å¶å­èŠ‚ç‚¹ï¼ˆLeafï¼‰ï¼šç»§æ‰¿/å®ç°è‡ªæŠ½è±¡ç»„ä»¶ï¼Œè¡¨ç¤ºå¶å­èŠ‚ç‚¹å¯¹è±¡ã€‚

   æ–‡ä¸­ç¤ºä¾‹ä¸ºï¼šIdCardCheckerå’ŒPhoneChecker

3. å®¹å™¨èŠ‚ç‚¹ï¼ˆCompositeï¼‰ï¼šç»§æ‰¿è‡ªæŠ½è±¡ç»„ä»¶ï¼Œè¡¨ç¤ºå®¹å™¨èŠ‚ç‚¹å¯¹è±¡ï¼ŒåŒ…å«å­ç»„ä»¶åˆ—è¡¨ã€‚

   æ–‡ä¸­ç¤ºä¾‹ä¸ºï¼šCompositeï¼›å­ç»„ä»¶åˆ—è¡¨ä¸ºï¼šprivate List childrenã€‚

## æ€»ç»“

ç»„åˆæ¨¡å¼æ˜¯ä¸€ç§ç»“æ„å‹è®¾è®¡æ¨¡å¼ï¼Œå®ƒå°†å¯¹è±¡ç»„ç»‡æˆæ ‘å½¢ç»“æ„ï¼Œä½¿å¾—å®¢æˆ·ç«¯å¯ä»¥ä»¥ç»Ÿä¸€çš„æ–¹å¼å¤„ç†å•ä¸ªå¯¹è±¡å’Œç»„åˆå¯¹è±¡ã€‚