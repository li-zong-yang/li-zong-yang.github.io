# è´£ä»»é“¾æ¨¡å¼

> ä½œè€…ï¼šç¬¬ä¸ƒäººæ ¼               
> é“¾æ¥ï¼šhttps://juejin.cn/post/7331579180997574682             
> æ¥æºï¼šç¨€åœŸæ˜é‡‘                  
> è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚                    

---------

âœ¨è¿™é‡Œæ˜¯ç¬¬ä¸ƒäººæ ¼çš„åšå®¢âœ¨å°ä¸ƒï¼Œæ¬¢è¿æ‚¨çš„åˆ°æ¥~âœ¨

ğŸ…ç³»åˆ—ä¸“æ ï¼šè®¾è®¡æ¨¡å¼ğŸ…

âœˆï¸æœ¬ç¯‡å†…å®¹: è´£ä»»é“¾æ¨¡å¼âœˆï¸

ğŸ± æœ¬ç¯‡æ”¶å½•å®Œæ•´ä»£ç åœ°å€ï¼š[gitee.com/diqirenge/dâ€¦](https://link.juejin.cn?target=https%3A%2F%2Fgitee.com%2Fdiqirenge%2Fdesign-pattern "https://gitee.com/diqirenge/design-pattern") ğŸ±

## æ¥”å­

å°ä¸ƒåˆšå…¥è¡Œçš„æ—¶å€™ï¼Œæœ‰ä¸€ä¸ªä¸šåŠ¡éœ€æ±‚éœ€è¦æ ¹æ®ä¸åŒçš„æ¡ä»¶ï¼Œè¿›è¡Œä¸åŒçš„å±‚çº§å®¡æ ¸ï¼Œæœ€å¤šè¦è¿›è¡Œ7çº§å®¡æ ¸^\_^ï¼Œè®©å°ä¸ƒè‡³ä»Šéƒ½è®°å¿†çŠ¹æ–°ã€‚å› ä¸ºå½“æ—¶å·¥æœŸç´§å¼ ï¼Œå°ä¸ƒå’Œä¼™ä¼´ä»¬ç›´æ¥å°±ä¸Šäº†if-elseå¤§æ³•ã€‚ç°åœ¨æƒ³ä¸€æƒ³å…¶å®å¯ä»¥åšçš„è®¾è®¡æœ‰å¾ˆå¤šï¼Œæ¯”å¦‚å¼•å…¥æµç¨‹å¼•æ“ï¼Œæˆ–è€…ä½¿ç”¨è´£ä»»é“¾æ¨¡å¼ç¼–å†™ä»£ç éƒ½å¯ä»¥ã€‚

![AuditChain.png](https://img.52javaee.com/blog20241008230646.webp)



## éœ€æ±‚èƒŒæ™¯

ç°åœ¨æœ‰ä¸‰çº§å®¡æ ¸ï¼Œéœ€è¦æ ¹æ®æ—¶é—´æ®µçš„ä¸åŒè®¾ç½®ä¸åŒçš„å®¡æ ¸ç­–ç•¥ã€‚

1ã€æ¯æœˆ1-10å·åªéœ€è¦ä¸‰çº§å®¡æ‰¹ï¼›

2ã€æ¯æœˆ11-20å·ï¼Œéœ€è¦äºŒçº§å®¡æ‰¹ + ä¸‰çº§å®¡æ‰¹ï¼›

3ã€æ¯æœˆ21å·åŠä»¥åï¼Œéœ€è¦ä¸€çº§å®¡æ‰¹+äºŒçº§å®¡æ‰¹ + ä¸‰çº§å®¡æ‰¹ï¼›

è¦æ±‚ä¸èƒ½å¼•å…¥æµç¨‹å¼•æ“ç­‰æ¡†æ¶ï¼Œåªèƒ½ä½¿ç”¨åŸç”ŸJavaå®ç°ã€‚

## åˆ†æè®¾è®¡

æ ¹æ®éœ€æ±‚æˆ‘ä»¬å¯ä»¥å°†å®¡æ ¸çš„å…¨æµç¨‹çœ‹åšæ˜¯ä¸€ä¸ªé“¾è·¯ï¼Œè€Œå…·ä½“æ˜¯å“ªå‡ çº§å®¡æ ¸å¯ä»¥çœ‹åšæ˜¯é“¾è·¯ä¸Šçš„èŠ‚ç‚¹ï¼Œæˆ–è€…æ˜¯å­é“¾è·¯ï¼Œæˆ‘ä»¬è¦æƒ³åŠæ³•å°†è¿™äº›é“¾è·¯è¿æ¥èµ·æ¥ï¼Œå‚è€ƒä»¥å‰å­¦è¿‡çš„å»ºé€ è€…æ¨¡å¼ï¼Œæˆ‘ä»¬å¯ä»¥è€ƒè™‘æŠ½è±¡ä¸€ä¸ªç±»ï¼Œé‡Œé¢æä¾›ä¸€ä¸ªæ–¹æ³•ï¼Œä¼ å…¥è‡ªå·±å¹¶ä¸”è¿”å›è‡ªå·±

```java
 ä»£ç è§£è¯»public abstract class AuditChain{
	private AuditChain next;
	public AuditChain addChain(AuditChain next) {
    	this.next = next;
    	return this;
	}
}
```

å†æä¾›ä¸€ä¸ªæ–¹æ³•ï¼Œç§»åŠ¨é“¾è·¯ï¼Œä»¥ä¾¿æ‰§è¡Œæ¯ä¸ªå­é“¾è·¯è‡ªå·±çš„ä¸šåŠ¡

```java
 ä»£ç è§£è¯»public AuditChain next() {
    return next;
}
```

è¿™æ ·åŸºç¡€çš„æŠ½è±¡ç±»æ¡†æ¶å°±æ­å»ºå¥½äº†ã€‚å†å¾€é‡Œé¢å¡«å……æˆ‘ä»¬çš„ä¸šåŠ¡æ–¹æ³•ï¼Œå»¶è¿Ÿåˆ°å­ç±»å®ç°å°±å¯ä»¥äº†ã€‚

## UMLå›¾

æ ¹æ®åˆ†æè®¾è®¡ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆç”»ä¸€ä¸ªç®€å•çš„UMLå›¾ï¼Œåé¢é€šè¿‡UMLå›¾ç¼–ç 

![F1AF61C3989146275FA316E2AE25F173.jpg](https://img.52javaee.com/blog20241008230645.webp)

## æ¨¡å—åç§°

responsibilitychain

## æ¨¡å—åœ°å€

[gitee.com/diqirenge/dâ€¦](https://link.juejin.cn?target=https%3A%2F%2Fgitee.com%2Fdiqirenge%2Fdesign-pattern%2Ftree%2Fmaster%2Fsrc%2Fmain%2Fjava%2Fcom%2Frun2code%2Fdesign%2Fbehavioral%2Fresponsibilitychain "https://gitee.com/diqirenge/design-pattern/tree/master/src/main/java/com/run2code/design/behavioral/responsibilitychain")

## æ¨¡å—æè¿°

è´£ä»»é“¾æ¨¡å¼ä»£ç ç¤ºä¾‹

## ä»£ç å®ç°

1ã€ç¼–å†™æ¥å£

æä¾›ä¸¤ä¸ªæ–¹æ³•

â‘ ã€è·å–ä¸‹ä¸€ä¸ªé“¾è·¯çš„æ–¹æ³•

â‘¡ã€æ·»åŠ ä¸‹ä¸€ä¸ªé“¾è·¯çš„æ–¹æ³•

```java
 ä»£ç è§£è¯»/**
 * é“¾è·¯å¤„ç†æ¥å£
 * å…³æ³¨å…¬ä¼—å·ã€å¥”è·‘çš„ç ç•œã€‘ï¼Œä¸€èµ·è¿›æ­¥ä¸è¿·è·¯
 *
 * @author ç¬¬ä¸ƒäººæ ¼
 * @date 2024/01/02
 */
public interface Handler {
    /**
     * è·å–ä¸‹ä¸€ä¸ªé“¾è·¯çš„æ–¹æ³•
     *
     * @return {@link AuditChain}
     */
    AuditChain next();

    /**
     * æ·»åŠ ä¸‹ä¸€ä¸ªé“¾è·¯çš„æ–¹æ³•
     *
     * @param next ä¸‹ä¸€ä¸ªé“¾è·¯
     * @return {@link AuditChain}
     */
    AuditChain addChain(AuditChain next);
}
```

2ã€ç¼–å†™æŠ½è±¡ç±»ï¼Œå®ç°Handleræ¥å£

å…³é”®ç‚¹åœ¨äºï¼š

â‘ è¯¥ç±»åŒ…å«ä¸€ä¸ªæŒ‡å‘ä¸‹ä¸€ä¸ªå¤„ç†å™¨çš„å¼•ç”¨`private AuditChain next;`

â‘¡å®šä¹‰ä¸€ä¸ªå¤„ç†æ–¹æ³•`addChain`

```kotlin
kotlin ä»£ç è§£è¯»public AuditChain addChain(AuditChain next) {
    this.next = next;
    return this;
}
```

```java
 ä»£ç è§£è¯»/**
 * å®¡æ ¸é“¾æŠ½è±¡ç±»
 * å…³æ³¨å…¬ä¼—å·ã€å¥”è·‘çš„ç ç•œã€‘ï¼Œä¸€èµ·è¿›æ­¥ä¸è¿·è·¯
 *
 * @author ç¬¬ä¸ƒäººæ ¼
 * @date 2024/01/02
 */
public abstract class AuditChain implements Handler {

    protected String auditorId;
    protected String auditorName;
    private AuditChain next;

    public static int getDayOfMonth(Date date) {
        Calendar calendar = Calendar.getInstance();
        calendar.setTime(date);
        return calendar.get(Calendar.DAY_OF_MONTH);
    }

    public AuditChain(String auditorId, String auditorName) {
        this.auditorId = auditorId;
        this.auditorName = auditorName;
    }

    public AuditChain next() {
        return next;
    }

    public AuditChain addChain(AuditChain next) {
        this.next = next;
        return this;
    }

    public abstract void audit(String orderId, Date auditDate);

}
```

3ã€ç¼–å†™å…·ä½“å®ç°ç±»

ä¸€çº§å®¡æ ¸

```java
 ä»£ç è§£è¯»/**
 * é“¾è·¯ï¼šä¸€çº§å®¡æ ¸
 * å¤§äºç­‰äº21å·ï¼Œæ‰éœ€è¦ä¸€çº§å®¡æ ¸
 * å…³æ³¨å…¬ä¼—å·ã€å¥”è·‘çš„ç ç•œã€‘ï¼Œä¸€èµ·è¿›æ­¥ä¸è¿·è·¯
 *
 * @author ç¬¬ä¸ƒäººæ ¼
 * @date 2024/01/02
 */
public class Level1Chain extends AuditChain {

    public Level1Chain(String auditorId, String auditorName) {
        super(auditorId, auditorName);
    }

    public void audit(String orderId, Date auditDate) {
        if (21 <= AuditChain.getDayOfMonth(auditDate)) {
            System.out.println("====>ä¸€çº§è´Ÿè´£äººï¼š" + auditorName + " å®¡æ ¸é€šè¿‡");
        }
        AuditChain next = super.next();
        if (next == null) {
            System.out.println("====>æœªæ‰¾åˆ°ä¸‹çº§å®¡æ ¸äººï¼Œæµç¨‹ç»“æŸ");
        } else {
            next.audit(orderId, auditDate);
        }
    }

}
```

äºŒçº§å®¡æ ¸

```java
 ä»£ç è§£è¯»/**
 * é“¾è·¯ï¼šäºŒçº§å®¡æ ¸
 * å¤§äºç­‰äº11å·ï¼Œæ‰éœ€è¦äºŒçº§å®¡æ ¸
 * å…³æ³¨å…¬ä¼—å·ã€å¥”è·‘çš„ç ç•œã€‘ï¼Œä¸€èµ·è¿›æ­¥ä¸è¿·è·¯
 *
 * @author ç¬¬ä¸ƒäººæ ¼
 * @date 2024/01/02
 */
public class Level2Chain extends AuditChain {

    public Level2Chain(String auditorId, String auditorName) {
        super(auditorId, auditorName);
    }

    public void audit(String orderId, Date auditDate) {
        if (11 <= AuditChain.getDayOfMonth(auditDate)) {
            System.out.println("====>äºŒçº§è´Ÿè´£äººï¼š" + auditorName + " å®¡æ ¸é€šè¿‡");
        }
        AuditChain next = super.next();
        if (next == null) {
            System.out.println("====>æœªæ‰¾åˆ°ä¸‹çº§å®¡æ ¸äººï¼Œæµç¨‹ç»“æŸ");
        } else {
            next.audit(orderId, auditDate);
        }
    }

}
```

ä¸‰çº§å®¡æ ¸

```java
 ä»£ç è§£è¯»/**
 * é“¾è·¯ï¼šä¸‰çº§å®¡æ ¸ã€
 * ä¸‰çº§å®¡æ ¸ä¸èƒ½è·³è¿‡
 * å…³æ³¨å…¬ä¼—å·ã€å¥”è·‘çš„ç ç•œã€‘ï¼Œä¸€èµ·è¿›æ­¥ä¸è¿·è·¯
 *
 * @author ç¬¬ä¸ƒäººæ ¼
 * @date 2024/01/02
 */
public class Level3Chain extends AuditChain {

    public Level3Chain(String auditorId, String auditorName) {
        super(auditorId, auditorName);
    }

    public void audit(String orderId, Date auditDate) {
        System.out.println("====>ä¸‰çº§è´Ÿè´£äººï¼š" + auditorName + " å®¡æ ¸é€šè¿‡");
        AuditChain next = super.next();
        if (next == null) {
            System.out.println("====>æœªæ‰¾åˆ°ä¸‹çº§å®¡æ ¸äººï¼Œæµç¨‹ç»“æŸ");
        } else {
            next.audit(orderId, auditDate);
        }
    }

}
```

4ã€ç¼–å†™æµ‹è¯•ç±»

```java
 ä»£ç è§£è¯»/**
 * æµ‹è¯•è´£ä»»é“¾æ¨¡å¼
 * å…³æ³¨å…¬ä¼—å·ã€å¥”è·‘çš„ç ç•œã€‘ï¼Œä¸€èµ·è¿›æ­¥ä¸è¿·è·¯
 *
 * @author ç¬¬ä¸ƒäººæ ¼
 * @date 2024/01/02
 */
public class ChainTest {

    @Test
    public void testAuditChain() {
        AuditChain auditChain = new Level3Chain("10086", "ç»åŠäººå°ç‹")
                        .addChain(new Level2Chain("002", "æç§‘")
                        .addChain(new Level1Chain("001", "å¼ å¤„")));

        System.out.println("\n====>æµ‹è¯•1-10å·çš„å®¡æ‰¹æµç¨‹");
        auditChain.audit("orderId0001", new Date("2024/10/01 22:22:22"));

        System.out.println("\n====>æµ‹è¯•11-20å·çš„å®¡æ‰¹æµç¨‹");
        auditChain.audit("orderId0002", new Date("2024/10/11 22:22:22"));

        System.out.println("\n====>æµ‹è¯•20å·åçš„å®¡æ‰¹æµç¨‹");
        auditChain.audit("orderId0003", new Date("2024/10/22 22:22:22"));
    }

}
```

4ã€æµ‹è¯•ç»“æœ

> \====>æµ‹è¯•1-10å·çš„å®¡æ‰¹æµç¨‹
>
> \====>ä¸‰çº§è´Ÿè´£äººï¼šç»åŠäººå°ç‹ å®¡æ ¸é€šè¿‡
>
> \====>æœªæ‰¾åˆ°ä¸‹çº§å®¡æ ¸äººï¼Œæµç¨‹ç»“æŸ

> \====>æµ‹è¯•11-20å·çš„å®¡æ‰¹æµç¨‹
>
> \====>ä¸‰çº§è´Ÿè´£äººï¼šç»åŠäººå°ç‹ å®¡æ ¸é€šè¿‡
>
> \====>äºŒçº§è´Ÿè´£äººï¼šæç§‘ å®¡æ ¸é€šè¿‡
>
> \====>æœªæ‰¾åˆ°ä¸‹çº§å®¡æ ¸äººï¼Œæµç¨‹ç»“æŸ

> \====>æµ‹è¯•20å·åçš„å®¡æ‰¹æµç¨‹
>
> \====>ä¸‰çº§è´Ÿè´£äººï¼šç»åŠäººå°ç‹ å®¡æ ¸é€šè¿‡
>
> \====>äºŒçº§è´Ÿè´£äººï¼šæç§‘ å®¡æ ¸é€šè¿‡
>
> \====>ä¸€çº§è´Ÿè´£äººï¼šå¼ å¤„ å®¡æ ¸é€šè¿‡
>
> \====>æœªæ‰¾åˆ°ä¸‹çº§å®¡æ ¸äººï¼Œæµç¨‹ç»“æŸ

## å®ç°è¦ç‚¹

æ¨¡æ¿æ¨¡å¼å®ç°è¦ç‚¹å¦‚ä¸‹ï¼š

1. å®šä¹‰ä¸€ä¸ªæŠ½è±¡å¤„ç†å™¨ç±»ï¼Œè¯¥ç±»åŒ…å«ä¸€ä¸ªæŒ‡å‘ä¸‹ä¸€ä¸ªå¤„ç†å™¨çš„å¼•ç”¨ï¼Œå¹¶å®šä¹‰ä¸€ä¸ªå¤„ç†æ–¹æ³•ã€‚

   ä¾‹å­ä¸­ä¸ºï¼šæŠ½è±¡å¤„ç†å™¨ç±»-AuditChainï¼Œå¼•ç”¨nextï¼Œå¤„ç†æ–¹æ³•addChainã€‚

2. åˆ›å»ºå…·ä½“çš„å¤„ç†å™¨ç±»ï¼Œæ¯ä¸ªå¤„ç†å™¨ç±»éƒ½ç»§æ‰¿è‡ªæŠ½è±¡å¤„ç†å™¨ç±»ï¼Œå¹¶å®ç°å¤„ç†æ–¹æ³•ã€‚åœ¨å¤„ç†æ–¹æ³•ä¸­ï¼Œé¦–å…ˆåˆ¤æ–­å½“å‰å¤„ç†å™¨æ˜¯å¦å¯ä»¥å¤„ç†è¯·æ±‚ï¼Œå¦‚æœå¯ä»¥åˆ™å¤„ç†è¯·æ±‚ï¼Œå¦åˆ™å°†è¯·æ±‚ä¼ é€’ç»™ä¸‹ä¸€ä¸ªå¤„ç†å™¨ã€‚

   ä¾‹å­ä¸­ä¸ºï¼šLevel1Chainã€Level2Chainã€Level3Chainçš„auditæ–¹æ³•ã€‚

3. å®¢æˆ·ç«¯ä»£ç åˆ›å»ºä¸€ä¸ªå¤„ç†å™¨é“¾ï¼Œå¹¶å°†è¯·æ±‚ä»é“¾çš„ä¸€ç«¯ä¼ é€’åˆ°å¦ä¸€ç«¯ã€‚

   ä¾‹å­ä¸­ä¸ºï¼š

   ```java
   java ä»£ç è§£è¯»AuditChain auditChain = new Level3Chain("10086", "ç»åŠäººå°ç‹")
           .addChain(new Level2Chain("002", "æç§‘")
                   .addChain(new Level1Chain("001", "å¼ å¤„")));
   ```

## æ€»ç»“

è´£ä»»é“¾æ¨¡å¼æ˜¯ä¸€ç§è¡Œä¸ºå‹è®¾è®¡æ¨¡å¼ï¼Œå®ƒæ—¨åœ¨å°†è¯·æ±‚çš„å‘é€è€…å’Œæ¥æ”¶è€…åˆ†ç¦»ï¼Œä½¿å¤šä¸ªå¤„ç†å¯¹è±¡éƒ½æœ‰å¯èƒ½æ¥æ”¶å¹¶å¤„ç†è¯·æ±‚ã€‚